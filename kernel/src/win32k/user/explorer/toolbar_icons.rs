//! Toolbar Icons
//!
//! Embedded 16x16 toolbar button icons matching Windows XP/2003 style.
//! Icons are stored as 1-bit bitmaps (monochrome with transparency).
//!
//! Based on Windows Server 2003 shell/comctl32/histsm.bmp and viewsm.bmp

use super::super::super::{ColorRef, Rect};
use super::super::super::gdi::surface::Surface;

/// Icon size (16x16 pixels)
pub const ICON_SIZE: i32 = 16;

/// Icon data: 16 rows of 16 bits (2 bytes per row = 32 bytes per icon)
/// Bit 1 = foreground color, Bit 0 = background/transparent

/// Back arrow icon (green left arrow)
pub static ICON_BACK: [u8; 32] = [
    0x00, 0x00, // ................
    0x00, 0x00, // ................
    0x02, 0x00, // ......#.........
    0x06, 0x00, // .....##.........
    0x0E, 0x00, // ....###.........
    0x1F, 0xF0, // ...#########....
    0x3F, 0xF0, // ..##########....
    0x7F, 0xF0, // .###########....
    0x3F, 0xF0, // ..##########....
    0x1F, 0xF0, // ...#########....
    0x0E, 0x00, // ....###.........
    0x06, 0x00, // .....##.........
    0x02, 0x00, // ......#.........
    0x00, 0x00, // ................
    0x00, 0x00, // ................
    0x00, 0x00, // ................
];

/// Forward arrow icon (green right arrow)
pub static ICON_FORWARD: [u8; 32] = [
    0x00, 0x00, // ................
    0x00, 0x00, // ................
    0x00, 0x40, // .........#......
    0x00, 0x60, // .........##.....
    0x00, 0x70, // .........###....
    0x0F, 0xF8, // ....#########...
    0x0F, 0xFC, // ....##########..
    0x0F, 0xFE, // ....###########.
    0x0F, 0xFC, // ....##########..
    0x0F, 0xF8, // ....#########...
    0x00, 0x70, // .........###....
    0x00, 0x60, // .........##.....
    0x00, 0x40, // .........#......
    0x00, 0x00, // ................
    0x00, 0x00, // ................
    0x00, 0x00, // ................
];

/// Up arrow icon (folder with up arrow)
pub static ICON_UP: [u8; 32] = [
    0x00, 0x00, // ................
    0x01, 0x80, // .......##.......
    0x03, 0xC0, // ......####......
    0x07, 0xE0, // .....######.....
    0x0F, 0xF0, // ....########....
    0x01, 0x80, // .......##.......
    0x01, 0x80, // .......##.......
    0x01, 0x80, // .......##.......
    0x01, 0x80, // .......##.......
    0x7F, 0xFC, // .#############..
    0x7F, 0xFC, // .#############..
    0x40, 0x04, // .#..........#...
    0x40, 0x04, // .#..........#...
    0x40, 0x04, // .#..........#...
    0x7F, 0xFC, // .#############..
    0x00, 0x00, // ................
];

/// Refresh icon (circular arrows)
pub static ICON_REFRESH: [u8; 32] = [
    0x00, 0x00, // ................
    0x00, 0x70, // .........###....
    0x0F, 0xF8, // ....#########...
    0x1C, 0x1C, // ...###.....###..
    0x30, 0x0C, // ..##.........##.
    0x60, 0x06, // .##...........##
    0x60, 0x00, // .##.............
    0x60, 0x00, // .##.............
    0x00, 0x06, // ...........##...
    0x00, 0x06, // ...........##...
    0x60, 0x06, // .##...........##
    0x30, 0x0C, // ..##.........##.
    0x1C, 0x1C, // ...###.....###..
    0x0F, 0xF0, // ....########....
    0x0E, 0x00, // ....###.........
    0x00, 0x00, // ................
];

/// View/Folders icon (folder)
pub static ICON_FOLDERS: [u8; 32] = [
    0x00, 0x00, // ................
    0x00, 0x00, // ................
    0x3E, 0x00, // ..#####.........
    0x7F, 0x00, // .#######........
    0xFF, 0xFE, // ###############.
    0xFF, 0xFE, // ###############.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0x80, 0x02, // #.............#.
    0xFF, 0xFE, // ###############.
    0x00, 0x00, // ................
    0x00, 0x00, // ................
];

/// Search icon (magnifying glass)
pub static ICON_SEARCH: [u8; 32] = [
    0x00, 0x00, // ................
    0x07, 0xC0, // .....#####......
    0x1F, 0xF0, // ...#########....
    0x38, 0x38, // ..###.....###...
    0x30, 0x18, // ..##.......##...
    0x60, 0x0C, // .##.........##..
    0x60, 0x0C, // .##.........##..
    0x60, 0x0C, // .##.........##..
    0x30, 0x18, // ..##.......##...
    0x38, 0x38, // ..###.....###...
    0x1F, 0xF0, // ...#########....
    0x07, 0xE0, // .....######.....
    0x00, 0x70, // .........###....
    0x00, 0x38, // ..........###...
    0x00, 0x18, // ...........##...
    0x00, 0x00, // ................
];

/// Draw a 16x16 monochrome icon onto a surface
pub fn draw_icon(
    surf: &Surface,
    x: i32,
    y: i32,
    icon_data: &[u8; 32],
    fg_color: ColorRef,
) {
    for row in 0..16 {
        let byte_hi = icon_data[row * 2];
        let byte_lo = icon_data[row * 2 + 1];
        let bits: u16 = ((byte_hi as u16) << 8) | (byte_lo as u16);

        for col in 0..16 {
            // Check if bit is set (MSB first)
            if (bits >> (15 - col)) & 1 == 1 {
                surf.set_pixel(x + col, y + row as i32, fg_color);
            }
        }
    }
}

/// Draw a toolbar button icon at the specified position
/// icon_index: 0=Back, 1=Forward, 2=Up, 3=Refresh, 4=Folders, 5=Search
pub fn draw_toolbar_icon(
    surf: &Surface,
    x: i32,
    y: i32,
    icon_index: usize,
    enabled: bool,
) {
    let icon_data = match icon_index {
        0 => &ICON_BACK,
        1 => &ICON_FORWARD,
        2 => &ICON_UP,
        3 => &ICON_REFRESH,
        4 => &ICON_FOLDERS,
        5 => &ICON_SEARCH,
        _ => return,
    };

    // Use green for navigation arrows (like Windows XP), black for others
    let fg_color = if enabled {
        match icon_index {
            0 | 1 => ColorRef::rgb(0, 128, 0),    // Green for Back/Forward
            2 => ColorRef::rgb(255, 200, 0),      // Yellow-gold for Up folder
            3 => ColorRef::rgb(0, 128, 0),        // Green for Refresh
            4 => ColorRef::rgb(255, 200, 0),      // Yellow for Folders
            5 => ColorRef::rgb(0, 0, 128),        // Blue for Search
            _ => ColorRef::rgb(0, 0, 0),
        }
    } else {
        ColorRef::rgb(128, 128, 128)  // Gray for disabled
    };

    draw_icon(surf, x, y, icon_data, fg_color);
}
